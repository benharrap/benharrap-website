<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Harrap">
<meta name="dcterms.date" content="2021-07-30">

<title>Thinking About Gender Identity – Ben Harrap</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../..//img/randy.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-76a1943aa528a4846e4152a694de7f96.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d6c0234beb521fbcf326a66e2c93b7a4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@100..900&amp;family=Nunito:ital,wght@0,200..1000;1,200..1000&amp;display=swap" rel="stylesheet">
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="benharrap" data-description="Support me on Buy me a coffee!" data-message="" data-color="#ffddd6" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XYMGR0N804"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XYMGR0N804');
</script>


<meta property="og:title" content="Thinking About Gender Identity – Ben Harrap">
<meta property="og:description" content="">
<meta property="og:image" content="https://benharrap.com/img/randy-og.png">
<meta property="og:site_name" content="Ben Harrap">
<meta property="og:image:alt" content="A white and fawn greyhound with its tongue poking out, wearing a black cowboy hat and red neckerchief">
<meta property="og:image:height" content="459">
<meta property="og:image:width" content="900">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ben Harrap</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../post.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Thinking About Gender Identity</h1>
  <div class="quarto-categories">
    <div class="quarto-category">self</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Harrap </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 30, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>I thought I would gather my thoughts on my gender identity in this post. Partly for me to keep track of thoughts and feelings I’ve had, and partly in the hopes that it could be useful to someone. I’d also like to point out that this isn’t an academic work on gender identity, it’s not meant to be profound, it’s really just a diary of sorts on my personal experience and thoughts.</p>
<section id="where-it-all-began" class="level2">
<h2 class="anchored" data-anchor-id="where-it-all-began">Where it all began</h2>
<p>I was sitting on the couch, idly scrolling Twitter, when my partner asked me “how would you feel if somebody used she to refer to you”. I paused for a bit, and came to the conclusion that it wouldn’t bother me. I hadn’t ever thought about pronouns before, since up until that point I had gone along with the idea that I was a man. My reasoning at the time was that an ‘incorrect’ pronoun didn’t really matter as long as it was clear that the pronoun being used was referring to me.</p>
<p>I thought it was an interesting question, but didn’t think much more of it at the time. But in the following days my mind kept returning to that question - why doesn’t it bother me what pronouns people use? That’s when I asked myself the question</p>
<blockquote class="blockquote">
<p>Am I male?</p>
</blockquote>
<p>It wasn’t a question I had an immediate answer to, but as soon as I asked it I felt some anxiety. That anxiety would come back every time my mind returned to the question. I’m not sure why I felt anxious - maybe it was the uncertainty of not knowing myself, or from challenging the male identity, or feeling that having ‘been male’ for so long I wasn’t allowed to be anything else? At any rate, the rumblings of ditching my male identity had begun, but what it was going to be replaced with I wasn’t sure.</p>
</section>
<section id="trying-to-figure-it-out" class="level2">
<h2 class="anchored" data-anchor-id="trying-to-figure-it-out">Trying to figure it out</h2>
<p>So at this point I wasn’t quite sure what my gender identity might be, but at the very least the words ‘man’ or ‘guy’ or ‘bloke’ didn’t feel like they described me. Even arriving at these thoughts I was still second-guessing myself. People talk about having known since they were a child that their identity didn’t fit what they were being told - and that’s great! But I was modelling my expectations of understanding my own identity on this inherent ‘just knowing’, which I realise now was foolish. Everyone’s journey toward understanding themselves is different and my journey started with a feeling of ‘something’s not right but I’m not sure what that means’. In hindsight of course everyone’s journey is different, but at the time I was frustrated that I didn’t ‘just know’.</p>
<p>Up until this point, my knowledge of what it meant to be non-binary was pretty superficial. I understood it meant having a gender identity that didn’t fit into the binary categories of male and female, but that was it. I did a bit of googling and learned about the umbrella that is non-binary, and all the different ways that people identify under it (e.g.&nbsp;genderqueer, agender, genderfluid). I thought maybe agender sounded right, but needed to dwell on it some more.</p>
<p>In doing my very academic google search I realised that I hadn’t listened to the experiences of non-binary people who were generous enough to share them (sorry for being a bad ally) - the closest I’d come was incidental thanks to Jonathan Van Ness on Queer Eye. So I sought out people talking about their experience being non-binary. One of the first articles I came across was <a href="https://www.teenvogue.com/story/what-it-means-to-be-non-binary">this article on Teen Vogue</a>. Seeing the diverse appearance and experiences of non-binary people was fantastic and really drove home that there isn’t a non-binary ‘look’.</p>
<p>Serendipitously, the day that I thought I might be non-binary was actually <a href="https://en.wikipedia.org/wiki/International_Non-Binary_People%27s_Day">International Non-Binary Day</a>, which meant there were a wealth of posts on Twitter and videos on YouTube on what it means to be non-binary. This tweet thread by Professor Sandy O’Sullivan is brilliant and further challenged any preconceptions I might’ve had about non-binary people:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
Hey, today (14 July) is International Non-Binary Awareness Day! <br><br>Let's all be aware of fabulous non-binary people!<br>Here's me looking all non-binary yesterday. Do you have a photo, story or a bit of appreciation to share?<br><br>Some non-binary mythbusting below! <a href="https://t.co/vpXEo9QVEt">pic.twitter.com/vpXEo9QVEt</a>
</p>
— Prof Sandy O'Sullivan (Wiradjuri, trans they/them) (<span class="citation" data-cites="sandyosullivan">@sandyosullivan</span>) <a href="https://twitter.com/sandyosullivan/status/1414965732773793794?ref_src=twsrc%5Etfw">July 13, 2021</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>The below video (which my partner kindly sent me) has <a href="https://www.youtube.com/channel/UCPJHQ5_DLtxZ1gzBvZE99_g">Anthony Padilla</a> interviewing several non-binary people to do some myth-busting and talk about their experiences. This was also helpful and I’m really grateful to Jeffrey, Jacob, and Angel for being so open.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LzEWEQiytoQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p>All of the videos and discussions of non-binary identity helped shatter my pre-conceptions of what it meant to be non-binary. The big one for me was associating androgyny with non-binary. As many non-binary folk have said, non-binary people don’t owe you androgyny. Ditching these stereotypes made it clearer to me that non-binary was something that I could indeed be.</p>
</section>
<section id="struggling-with-it" class="level2">
<h2 class="anchored" data-anchor-id="struggling-with-it">Struggling with it</h2>
<p>One of the things I found challenging to get to grips with was that gender identity doesn’t have to stay the same. Intellectually I understood this - of course you can feel male one day, non-binary another day, then male again. Emotionally I was having a hard time, I think because I wanted to have some certainty so I could figure out the ‘right answer’ and move on. Eventually I came to terms with gender not being fixed - mostly by just dwelling on it for some time. I found reframing the question from “what is my gender identity” to “what is my gender identity <em>at the moment</em>” helpful. Gender didn’t need to be some immutable characteristic.</p>
<p>The next big challenge I came up against was saying words out loud. Up until now, everything had been happening in my head. But there’s a strange power in saying things out loud. At first it was awkward. I started by saying it out loud to myself. “I’m non-binary”. It felt weird and uncomfortable - like I was saying something I wasn’t meant to say - but it was also exciting. Then I said it to my partner, “hey, so I… uhhh… think I’m non-binary?” - it sounded much less certain that time. I think through practice and repetition I’ll feel more confident in owning my identity.</p>
<p>It doesn’t feel as weird to say it out loud any more, but I still feel a sense of anxiety around saying it to people. My world has gone from assuming everyone around me is kind, supportive, and understanding (which they are), to being paranoid that they’ll react negatively if I told them. It’s sad that such stigma exists, nobody should be made to feel uncomfortable about who they are.</p>
<p>I reached out to a non-binary person who I knew, asking them if they’d be willing to have a chat about their experience. They were so kind and I’m so grateful that they were willing to listen to my probably silly questions and ramblings. I still felt a little unsure at the time, finding it difficult to pick the right words to describe what I was feeling, but they were reassuring and let me just talk. Talking actually turned out to be quite difficult, I think because I was still figuring out how to talk about being non-binary, but I didn’t feel like I could find the right language to use either.</p>
<p>While I was writing this I decided to tell one of my PhD supervisors. The experience was terrifying and exhilarating. “Hey, can I tell you something? I’m non-binary”. It was abrupt but it felt right! They were kind in their reaction and asked me if I was changing my pronouns. I felt awkward because I didn’t know what reaction to expect. In one respect I felt like it was a big deal that needed celebrating, but it also doesn’t feel like a big deal because I haven’t really changed - if anything I’m more <em>me</em>. I must admit, in an effort to avoid any awkwardness I kept talking to fill in any potential silence and proceeded to over-explain and justify why I identified as such. On reflection, I definitely didn’t need to justify it - but I’m still learning.</p>
</section>
<section id="the-start-of-the-journey" class="level2">
<h2 class="anchored" data-anchor-id="the-start-of-the-journey">The start of the journey</h2>
<p>Having reached the comfortable conclusion that I am non-binary (at the moment) feels good. It certainly wasn’t as big of a deal as I initially thought it would be. I’m still the same person, I just know myself better now.</p>
<p>An analogy that works for me is that I’d been sitting in a dark gender-identity room my whole life. In the darkness the only thing I knew was the male identity. Recently, I noticed a little gender-identity light-switch on the wall, but the light-switch was surrounded by big patriarchy signs saying “WARNING DO NOT TOUCH” and “DANGER”. So the thought of switching the light on was <em>very</em> scary. I had to fight the anxiety and muster up the courage to flip the switch, all the while worrying about the massive ramifications that would follow. But after turning the lights on, nothing bad happened - the signs were bullshit. In fact, nothing much happened at all - I could just see the room better.</p>
<p>It was liberating. Freeing myself from binary gender has got me challenging a lot of the things that I used to tell myself “that’s not for you”. For example, I want to get myself a cute <span style="background-color:#FFD9C2">peach-coloured</span> jumper. It feels kinda stupid, saying that with my new found identity I want to get a colourful jumper, but honestly, feeling like I <em>shouldn’t</em> like colourful jumpers is the kind of dumb shit that being raised as a male in a patriarchal society teaches you.</p>
</section>
<section id="afterthoughts" class="level2">
<h2 class="anchored" data-anchor-id="afterthoughts">Afterthoughts</h2>
<p>It felt weird writing this and typing that I was a man - it definitely doesn’t feel like the right descriptor any more. Perhaps it never was, or perhaps it was until recently? I’ll never know since I can’t go back in time and interrogate my thoughts on my gender identity. I wrote this up and left it for a couple of days, stewing some more. I’ve started having feelings of “maybe I’m not non-binary, maybe I’m being silly” but then I return to the same question “am I a man” and the answer is still no. I don’t know what to make of that at the moment, I’ll just sit with it for now and see how I feel in the coming weeks.</p>
<p>Something I’m still aware of is my ostensibly masculine appearance. I was raised male and with that came privilege. I’ve been thinking about male privilege and how I benefit from it for far longer than I’ve been thinking about my gender identity, but this adds a new complexity. I assume people will still see me as male and treat me as such - my internal change hasn’t changed my external appearance, which is how people see me. The challenge I find is that I’m considering how other people perceive me and trying to shape my behaviour accordingly. This seems silly though, I’ll just be acting a gender identity that isn’t mine. So I’m also paying more attention to how I respond to others and trying to act in a way which is true to me, not true for what others might expect from me.</p>
<p>All in all, I’m still the same person in all the nuanced ways that make me me. And I don’t mind what pronouns you use.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/benharrap\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>