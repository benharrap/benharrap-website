<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Harrap">
<meta name="dcterms.date" content="2025-07-14">

<title>Not all missings are created equal – Ben Harrap</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../..//img/randy.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-76a1943aa528a4846e4152a694de7f96.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d6c0234beb521fbcf326a66e2c93b7a4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@100..900&amp;family=Nunito:ital,wght@0,200..1000;1,200..1000&amp;display=swap" rel="stylesheet">
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="benharrap" data-description="Support me on Buy me a coffee!" data-message="" data-color="#ffddd6" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XYMGR0N804"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XYMGR0N804');
</script>


<meta property="og:title" content="Not all missings are created equal – Ben Harrap">
<meta property="og:description" content="">
<meta property="og:image" content="https://benharrap.com/img/randy.png">
<meta property="og:site_name" content="Ben Harrap">
<meta property="og:image:alt" content="A white and fawn greyhound with its tongue poking out, wearing a black cowboy hat and red neckerchief">
<meta property="og:image:height" content="512">
<meta property="og:image:width" content="512">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ben Harrap</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../post.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Not all missings are created equal</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">programming</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Harrap </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 14, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>I posted this question on Bluesky the other day, because I wasn’t sure whether a row-wise or column-wise solution would perform better for the problem I was trying to solve.</p>
<blockquote class="bluesky-embed blockquote" data-bluesky-uri="at://did:plc:kk6ztlsaka6mdlpursuwd4yt/app.bsky.feed.post/3ltieznd74c2k" data-bluesky-cid="bafyreig2ngchvmshsw2thsgm5qscnvbvoi6jipcjuki5ee62t3stpi56dy" data-bluesky-embed-color-mode="system">
<p lang="en">
</p><p>Thoughts #rstats?</p>
<p>I'm updating values in col_n based on values in col_n+1 for every column in a dataframe (say 500 cols), for tens of thousands of rows.</p>
Do you expect doing colwise operations to be faster? Or transposing the data and doing rowwise operations?
<p></p>
— Ben Harrap (<a href="https://bsky.app/profile/did:plc:kk6ztlsaka6mdlpursuwd4yt?ref_src=embed"><span class="citation" data-cites="bharrap.bsky.social">@bharrap.bsky.social</span></a>) <a href="https://bsky.app/profile/did:plc:kk6ztlsaka6mdlpursuwd4yt/post/3ltieznd74c2k?ref_src=embed">July 9, 2025 at 8:47 AM</a>
</blockquote>
<script async="" src="https://embed.bsky.app/static/embed.js" charset="utf-8"></script>
<p>The feedback was consistent in stating that column-wise operations would be faster. So what did I do? I wrote a row-wise solution!</p>
<p>Ok hear me out though, there was a good reason and I’ll go through the problem and my thinking here, because the problem isn’t as simple as I’d laid out in my Bluesky post.</p>
<section id="the-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-problem">The problem</h2>
<p>People do questionnaires (this is not the problem). Some people skip a question or two, some people skip a whole set, and some people get bored and stop half-way. These all lead to missing data, but the pattern of missingness is different and is informative when thinking about designing the next survey wave’s questionnaire.</p>
<p>The problem is how to efficiently identify these types of missingness in the data and code them as such.</p>
<p>Let’s start with a data dictionary some example data to help illustrate.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_first =</span> <span class="fu">c</span>(<span class="st">"Tom"</span>, <span class="st">"Penny"</span>, <span class="st">"Trevor"</span>, <span class="st">"Ursula"</span>, <span class="st">"Jenny"</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_last =</span> <span class="fu">c</span>(<span class="st">"Smith"</span>, <span class="st">"Jones"</span>, <span class="cn">NA</span>, <span class="st">"Smith"</span>, <span class="st">"Jones"</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">62</span>,<span class="dv">52</span>,<span class="dv">37</span>,<span class="dv">44</span>,<span class="cn">NA</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_text =</span> <span class="fu">c</span>(<span class="st">"Lorem"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Lorem"</span>, <span class="cn">NA</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y1 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y2 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y3 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">z1 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">z2 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">z3 =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d"</span>), \(x) <span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="fu">round</span>(x))),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">everything</span>(), as.character)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(survey_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="utapxvmtle" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#utapxvmtle table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#utapxvmtle thead, #utapxvmtle tbody, #utapxvmtle tfoot, #utapxvmtle tr, #utapxvmtle td, #utapxvmtle th {
  border-style: none;
}

#utapxvmtle p {
  margin: 0;
  padding: 0;
}

#utapxvmtle .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#utapxvmtle .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#utapxvmtle .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#utapxvmtle .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#utapxvmtle .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#utapxvmtle .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#utapxvmtle .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#utapxvmtle .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#utapxvmtle .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#utapxvmtle .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#utapxvmtle .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#utapxvmtle .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#utapxvmtle .gt_spanner_row {
  border-bottom-style: hidden;
}

#utapxvmtle .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#utapxvmtle .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#utapxvmtle .gt_from_md > :first-child {
  margin-top: 0;
}

#utapxvmtle .gt_from_md > :last-child {
  margin-bottom: 0;
}

#utapxvmtle .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#utapxvmtle .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#utapxvmtle .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#utapxvmtle .gt_row_group_first td {
  border-top-width: 2px;
}

#utapxvmtle .gt_row_group_first th {
  border-top-width: 2px;
}

#utapxvmtle .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#utapxvmtle .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#utapxvmtle .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#utapxvmtle .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#utapxvmtle .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#utapxvmtle .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#utapxvmtle .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#utapxvmtle .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#utapxvmtle .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#utapxvmtle .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#utapxvmtle .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#utapxvmtle .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#utapxvmtle .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#utapxvmtle .gt_left {
  text-align: left;
}

#utapxvmtle .gt_center {
  text-align: center;
}

#utapxvmtle .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#utapxvmtle .gt_font_normal {
  font-weight: normal;
}

#utapxvmtle .gt_font_bold {
  font-weight: bold;
}

#utapxvmtle .gt_font_italic {
  font-style: italic;
}

#utapxvmtle .gt_super {
  font-size: 65%;
}

#utapxvmtle .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#utapxvmtle .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#utapxvmtle .gt_indent_1 {
  text-indent: 5px;
}

#utapxvmtle .gt_indent_2 {
  text-indent: 10px;
}

#utapxvmtle .gt_indent_3 {
  text-indent: 15px;
}

#utapxvmtle .gt_indent_4 {
  text-indent: 20px;
}

#utapxvmtle .gt_indent_5 {
  text-indent: 25px;
}

#utapxvmtle .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#utapxvmtle div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="id" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">id</th>
<th id="name_first" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">name_first</th>
<th id="name_last" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">name_last</th>
<th id="age" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">age</th>
<th id="x1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x1</th>
<th id="x2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x2</th>
<th id="x3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x3</th>
<th id="x_text" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">x_text</th>
<th id="y1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y1</th>
<th id="y2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y2</th>
<th id="y3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y3</th>
<th id="z1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">z1</th>
<th id="z2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">z2</th>
<th id="z3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">z3</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="id">1</td>
<td class="gt_row gt_left" headers="name_first">Tom</td>
<td class="gt_row gt_left" headers="name_last">Smith</td>
<td class="gt_row gt_right" headers="age">62</td>
<td class="gt_row gt_right" headers="x1">NA</td>
<td class="gt_row gt_right" headers="x2">1</td>
<td class="gt_row gt_right" headers="x3">NA</td>
<td class="gt_row gt_left" headers="x_text">Lorem</td>
<td class="gt_row gt_right" headers="y1">1</td>
<td class="gt_row gt_right" headers="y2">NA</td>
<td class="gt_row gt_right" headers="y3">NA</td>
<td class="gt_row gt_right" headers="z1">NA</td>
<td class="gt_row gt_right" headers="z2">NA</td>
<td class="gt_row gt_right" headers="z3">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="id">2</td>
<td class="gt_row gt_left" headers="name_first">Penny</td>
<td class="gt_row gt_left" headers="name_last">Jones</td>
<td class="gt_row gt_right" headers="age">52</td>
<td class="gt_row gt_right" headers="x1">0</td>
<td class="gt_row gt_right" headers="x2">NA</td>
<td class="gt_row gt_right" headers="x3">1</td>
<td class="gt_row gt_left" headers="x_text">NA</td>
<td class="gt_row gt_right" headers="y1">NA</td>
<td class="gt_row gt_right" headers="y2">NA</td>
<td class="gt_row gt_right" headers="y3">1</td>
<td class="gt_row gt_right" headers="z1">0</td>
<td class="gt_row gt_right" headers="z2">1</td>
<td class="gt_row gt_right" headers="z3">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="id">3</td>
<td class="gt_row gt_left" headers="name_first">Trevor</td>
<td class="gt_row gt_left" headers="name_last">NA</td>
<td class="gt_row gt_right" headers="age">37</td>
<td class="gt_row gt_right" headers="x1">1</td>
<td class="gt_row gt_right" headers="x2">NA</td>
<td class="gt_row gt_right" headers="x3">0</td>
<td class="gt_row gt_left" headers="x_text">NA</td>
<td class="gt_row gt_right" headers="y1">NA</td>
<td class="gt_row gt_right" headers="y2">NA</td>
<td class="gt_row gt_right" headers="y3">NA</td>
<td class="gt_row gt_right" headers="z1">NA</td>
<td class="gt_row gt_right" headers="z2">NA</td>
<td class="gt_row gt_right" headers="z3">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="id">4</td>
<td class="gt_row gt_left" headers="name_first">Ursula</td>
<td class="gt_row gt_left" headers="name_last">Smith</td>
<td class="gt_row gt_right" headers="age">44</td>
<td class="gt_row gt_right" headers="x1">1</td>
<td class="gt_row gt_right" headers="x2">NA</td>
<td class="gt_row gt_right" headers="x3">NA</td>
<td class="gt_row gt_left" headers="x_text">Lorem</td>
<td class="gt_row gt_right" headers="y1">NA</td>
<td class="gt_row gt_right" headers="y2">1</td>
<td class="gt_row gt_right" headers="y3">NA</td>
<td class="gt_row gt_right" headers="z1">NA</td>
<td class="gt_row gt_right" headers="z2">1</td>
<td class="gt_row gt_right" headers="z3">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="id">5</td>
<td class="gt_row gt_left" headers="name_first">Jenny</td>
<td class="gt_row gt_left" headers="name_last">Jones</td>
<td class="gt_row gt_right" headers="age">NA</td>
<td class="gt_row gt_right" headers="x1">NA</td>
<td class="gt_row gt_right" headers="x2">0</td>
<td class="gt_row gt_right" headers="x3">1</td>
<td class="gt_row gt_left" headers="x_text">NA</td>
<td class="gt_row gt_right" headers="y1">NA</td>
<td class="gt_row gt_right" headers="y2">NA</td>
<td class="gt_row gt_right" headers="y3">NA</td>
<td class="gt_row gt_right" headers="z1">1</td>
<td class="gt_row gt_right" headers="z2">0</td>
<td class="gt_row gt_right" headers="z3">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In this example, we’ve got the data in a tabular format with responses as rows and variables as columns. There’s an ID, the respondent’s names and age, then three sets of questions:</p>
<ul>
<li>The <code>x1</code> to <code>x_text</code> questions are all part of the <code>x</code> group of questions</li>
<li>The <code>y1</code> to <code>y3</code> and <code>z1</code> to <code>z3</code> questions are all part of the <code>y</code> and <code>z</code> group of questions, respectively</li>
</ul>
<p>Looking at this data, we can see that:</p>
<ul>
<li>Tom didn’t answer any of the <code>z</code> questions</li>
<li>Penny and Ursula have valid responses for at least one question from each group</li>
<li>Trevor didn’t give his last name and stopped responding after the <code>x</code> questions</li>
<li>Jenny didn’t respond to the <code>y</code> questions but answered at least one <code>z</code> question</li>
</ul>
</section>
<section id="a-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="a-dictionary">A dictionary</h2>
<p>Like any good dataset, a data dictionary is available:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dictionary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">names</span>(survey_data),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>,<span class="fu">rep</span>(<span class="st">"string"</span>,<span class="dv">2</span>),<span class="st">"numeric"</span>,<span class="fu">rep</span>(<span class="st">"factor"</span>,<span class="dv">3</span>),<span class="st">"string"</span>,<span class="fu">rep</span>(<span class="st">"factor"</span>,<span class="dv">6</span>)),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_group =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>, <span class="st">"name"</span>, <span class="st">"age"</span>, <span class="fu">rep</span>(<span class="st">"x"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"y"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"z"</span>, <span class="dv">3</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(dictionary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="irjtnphjbz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#irjtnphjbz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#irjtnphjbz thead, #irjtnphjbz tbody, #irjtnphjbz tfoot, #irjtnphjbz tr, #irjtnphjbz td, #irjtnphjbz th {
  border-style: none;
}

#irjtnphjbz p {
  margin: 0;
  padding: 0;
}

#irjtnphjbz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#irjtnphjbz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#irjtnphjbz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#irjtnphjbz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#irjtnphjbz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#irjtnphjbz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#irjtnphjbz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#irjtnphjbz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#irjtnphjbz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#irjtnphjbz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#irjtnphjbz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#irjtnphjbz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#irjtnphjbz .gt_spanner_row {
  border-bottom-style: hidden;
}

#irjtnphjbz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#irjtnphjbz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#irjtnphjbz .gt_from_md > :first-child {
  margin-top: 0;
}

#irjtnphjbz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#irjtnphjbz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#irjtnphjbz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#irjtnphjbz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#irjtnphjbz .gt_row_group_first td {
  border-top-width: 2px;
}

#irjtnphjbz .gt_row_group_first th {
  border-top-width: 2px;
}

#irjtnphjbz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#irjtnphjbz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#irjtnphjbz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#irjtnphjbz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#irjtnphjbz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#irjtnphjbz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#irjtnphjbz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#irjtnphjbz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#irjtnphjbz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#irjtnphjbz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#irjtnphjbz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#irjtnphjbz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#irjtnphjbz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#irjtnphjbz .gt_left {
  text-align: left;
}

#irjtnphjbz .gt_center {
  text-align: center;
}

#irjtnphjbz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#irjtnphjbz .gt_font_normal {
  font-weight: normal;
}

#irjtnphjbz .gt_font_bold {
  font-weight: bold;
}

#irjtnphjbz .gt_font_italic {
  font-style: italic;
}

#irjtnphjbz .gt_super {
  font-size: 65%;
}

#irjtnphjbz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#irjtnphjbz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#irjtnphjbz .gt_indent_1 {
  text-indent: 5px;
}

#irjtnphjbz .gt_indent_2 {
  text-indent: 10px;
}

#irjtnphjbz .gt_indent_3 {
  text-indent: 15px;
}

#irjtnphjbz .gt_indent_4 {
  text-indent: 20px;
}

#irjtnphjbz .gt_indent_5 {
  text-indent: 25px;
}

#irjtnphjbz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#irjtnphjbz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">type</th>
<th id="variable_group" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable_group</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">id</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="variable_group">id</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">name_first</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">name_last</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">age</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="variable_group">age</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x1</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x2</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x3</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x_text</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y1</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">y2</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y3</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z1</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">z2</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z3</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It’s rudimentary but will serve its purpose to illustrate how we can use it in data cleaning and the reason for why I opted for a row-wise solution.</p>
</section>
<section id="my-solution" class="level2">
<h2 class="anchored" data-anchor-id="my-solution">My solution</h2>
<p>The column-wise solution for identifying the drop-offs is fairly straightforward, but I wasn’t sure how to incorporate missingness at the question group level where the participant had not dropped off (e.g.&nbsp;Jenny). Maybe I’m too tidyverse-pilled, but I found it much easier to solve this problem using <code>group_by()</code>.</p>
<p>To start with, we need to transpose the data such that participant responses are in columns and the variables are in rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a>survey_data_tranposed <span class="ot">&lt;-</span> survey_data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">any_of</span>(dictionary<span class="sc">$</span>variable)) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-3-3" class="code-annotation-target"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-3-5" class="code-annotation-target"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"variable"</span>)</span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(survey_data_tranposed)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="3" data-code-annotation="1"><code>t()</code> transposes the data into a matrix</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Convert it back into a data frame</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="5" data-code-annotation="3">Then take the row names (which were previously column names) and turn them into the <code>variable</code> column.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="kvkzvmqdbt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kvkzvmqdbt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvkzvmqdbt thead, #kvkzvmqdbt tbody, #kvkzvmqdbt tfoot, #kvkzvmqdbt tr, #kvkzvmqdbt td, #kvkzvmqdbt th {
  border-style: none;
}

#kvkzvmqdbt p {
  margin: 0;
  padding: 0;
}

#kvkzvmqdbt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvkzvmqdbt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvkzvmqdbt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvkzvmqdbt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvkzvmqdbt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvkzvmqdbt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvkzvmqdbt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvkzvmqdbt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvkzvmqdbt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvkzvmqdbt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvkzvmqdbt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvkzvmqdbt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvkzvmqdbt .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvkzvmqdbt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvkzvmqdbt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvkzvmqdbt .gt_from_md > :first-child {
  margin-top: 0;
}

#kvkzvmqdbt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvkzvmqdbt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvkzvmqdbt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvkzvmqdbt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvkzvmqdbt .gt_row_group_first td {
  border-top-width: 2px;
}

#kvkzvmqdbt .gt_row_group_first th {
  border-top-width: 2px;
}

#kvkzvmqdbt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvkzvmqdbt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvkzvmqdbt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvkzvmqdbt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvkzvmqdbt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvkzvmqdbt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvkzvmqdbt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvkzvmqdbt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvkzvmqdbt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvkzvmqdbt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvkzvmqdbt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvkzvmqdbt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvkzvmqdbt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvkzvmqdbt .gt_left {
  text-align: left;
}

#kvkzvmqdbt .gt_center {
  text-align: center;
}

#kvkzvmqdbt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvkzvmqdbt .gt_font_normal {
  font-weight: normal;
}

#kvkzvmqdbt .gt_font_bold {
  font-weight: bold;
}

#kvkzvmqdbt .gt_font_italic {
  font-style: italic;
}

#kvkzvmqdbt .gt_super {
  font-size: 65%;
}

#kvkzvmqdbt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvkzvmqdbt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvkzvmqdbt .gt_indent_1 {
  text-indent: 5px;
}

#kvkzvmqdbt .gt_indent_2 {
  text-indent: 10px;
}

#kvkzvmqdbt .gt_indent_3 {
  text-indent: 15px;
}

#kvkzvmqdbt .gt_indent_4 {
  text-indent: 20px;
}

#kvkzvmqdbt .gt_indent_5 {
  text-indent: 25px;
}

#kvkzvmqdbt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kvkzvmqdbt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="V1" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V1</th>
<th id="V2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V2</th>
<th id="V3" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V3</th>
<th id="V4" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V4</th>
<th id="V5" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V5</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">id</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">2</td>
<td class="gt_row gt_left" headers="V3">3</td>
<td class="gt_row gt_left" headers="V4">4</td>
<td class="gt_row gt_left" headers="V5">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">name_first</td>
<td class="gt_row gt_left" headers="V1">Tom</td>
<td class="gt_row gt_left" headers="V2">Penny</td>
<td class="gt_row gt_left" headers="V3">Trevor</td>
<td class="gt_row gt_left" headers="V4">Ursula</td>
<td class="gt_row gt_left" headers="V5">Jenny</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">name_last</td>
<td class="gt_row gt_left" headers="V1">Smith</td>
<td class="gt_row gt_left" headers="V2">Jones</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">Smith</td>
<td class="gt_row gt_left" headers="V5">Jones</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">age</td>
<td class="gt_row gt_left" headers="V1">62</td>
<td class="gt_row gt_left" headers="V2">52</td>
<td class="gt_row gt_left" headers="V3">37</td>
<td class="gt_row gt_left" headers="V4">44</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x1</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">1</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x2</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x3</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">0</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x_text</td>
<td class="gt_row gt_left" headers="V1">Lorem</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">Lorem</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y1</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">y2</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y3</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z1</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">z2</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z3</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">0</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now that the data’s in this format, we can join information from the dictionary</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>survey_data_tranposed <span class="ot">&lt;-</span> survey_data_tranposed <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dictionary, <span class="at">by =</span> <span class="st">"variable"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(variable_group,type), <span class="at">.after =</span> variable)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(survey_data_tranposed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="cqwwuxehtj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cqwwuxehtj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cqwwuxehtj thead, #cqwwuxehtj tbody, #cqwwuxehtj tfoot, #cqwwuxehtj tr, #cqwwuxehtj td, #cqwwuxehtj th {
  border-style: none;
}

#cqwwuxehtj p {
  margin: 0;
  padding: 0;
}

#cqwwuxehtj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cqwwuxehtj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cqwwuxehtj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cqwwuxehtj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cqwwuxehtj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqwwuxehtj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqwwuxehtj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqwwuxehtj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cqwwuxehtj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cqwwuxehtj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cqwwuxehtj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cqwwuxehtj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cqwwuxehtj .gt_spanner_row {
  border-bottom-style: hidden;
}

#cqwwuxehtj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cqwwuxehtj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cqwwuxehtj .gt_from_md > :first-child {
  margin-top: 0;
}

#cqwwuxehtj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cqwwuxehtj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cqwwuxehtj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cqwwuxehtj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cqwwuxehtj .gt_row_group_first td {
  border-top-width: 2px;
}

#cqwwuxehtj .gt_row_group_first th {
  border-top-width: 2px;
}

#cqwwuxehtj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqwwuxehtj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cqwwuxehtj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cqwwuxehtj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqwwuxehtj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqwwuxehtj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cqwwuxehtj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cqwwuxehtj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cqwwuxehtj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqwwuxehtj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqwwuxehtj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqwwuxehtj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqwwuxehtj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqwwuxehtj .gt_left {
  text-align: left;
}

#cqwwuxehtj .gt_center {
  text-align: center;
}

#cqwwuxehtj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cqwwuxehtj .gt_font_normal {
  font-weight: normal;
}

#cqwwuxehtj .gt_font_bold {
  font-weight: bold;
}

#cqwwuxehtj .gt_font_italic {
  font-style: italic;
}

#cqwwuxehtj .gt_super {
  font-size: 65%;
}

#cqwwuxehtj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cqwwuxehtj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cqwwuxehtj .gt_indent_1 {
  text-indent: 5px;
}

#cqwwuxehtj .gt_indent_2 {
  text-indent: 10px;
}

#cqwwuxehtj .gt_indent_3 {
  text-indent: 15px;
}

#cqwwuxehtj .gt_indent_4 {
  text-indent: 20px;
}

#cqwwuxehtj .gt_indent_5 {
  text-indent: 25px;
}

#cqwwuxehtj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cqwwuxehtj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="variable_group" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable_group</th>
<th id="type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">type</th>
<th id="V1" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V1</th>
<th id="V2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V2</th>
<th id="V3" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V3</th>
<th id="V4" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V4</th>
<th id="V5" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V5</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">id</td>
<td class="gt_row gt_left" headers="variable_group">id</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">2</td>
<td class="gt_row gt_left" headers="V3">3</td>
<td class="gt_row gt_left" headers="V4">4</td>
<td class="gt_row gt_left" headers="V5">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">name_first</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Tom</td>
<td class="gt_row gt_left" headers="V2">Penny</td>
<td class="gt_row gt_left" headers="V3">Trevor</td>
<td class="gt_row gt_left" headers="V4">Ursula</td>
<td class="gt_row gt_left" headers="V5">Jenny</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">name_last</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Smith</td>
<td class="gt_row gt_left" headers="V2">Jones</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">Smith</td>
<td class="gt_row gt_left" headers="V5">Jones</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">age</td>
<td class="gt_row gt_left" headers="variable_group">age</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="V1">62</td>
<td class="gt_row gt_left" headers="V2">52</td>
<td class="gt_row gt_left" headers="V3">37</td>
<td class="gt_row gt_left" headers="V4">44</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x1</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">1</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x2</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x3</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">0</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x_text</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Lorem</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">Lorem</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y1</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">y2</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y3</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z1</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V5">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">z2</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V5">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z3</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V4">0</td>
<td class="gt_row gt_left" headers="V5">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then I wrote the following function, which incorporates the information we just joined in how missingness categories are identified. The code annotations below the code chunk explain each step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a>code_missingness <span class="ot">&lt;-</span> <span class="cf">function</span>(data, column) {</span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-5-3" class="code-annotation-target"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">drop_off =</span> <span class="fu">row_number</span>() <span class="sc">&gt;</span> <span class="fu">max</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(column))))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_group) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-5"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-5-6" class="code-annotation-target"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">drop_off =</span> <span class="fu">min</span>(drop_off),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-5-7" class="code-annotation-target"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_vars =</span> <span class="fu">max</span>(<span class="fu">row_number</span>()),</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(column))),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">missingness =</span> <span class="fu">case_when</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-5-10" class="code-annotation-target"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a>        drop_off <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"-777777"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-5-11" class="code-annotation-target"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a>        n_vars <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> n_missing <span class="sc">==</span> n_vars <span class="sc">~</span> <span class="st">"-888888"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-5-12" class="code-annotation-target"><a href="#annotated-cell-5-12" aria-hidden="true" tabindex="-1"></a>        n_missing <span class="sc">!=</span> n_vars <span class="sc">&amp;</span></span>
<span id="annotated-cell-5-13"><a href="#annotated-cell-5-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(column)) <span class="sc">&amp;</span></span>
<span id="annotated-cell-5-14"><a href="#annotated-cell-5-14" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="st">"factor"</span> <span class="sc">~</span> <span class="st">"0"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-5-15" class="code-annotation-target"><a href="#annotated-cell-5-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(column)) <span class="sc">~</span> <span class="st">"-999999"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="9" onclick="event.preventDefault();">9</a><span id="annotated-cell-5-16" class="code-annotation-target"><a href="#annotated-cell-5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> <span class="sc">!!</span><span class="fu">sym</span>(column)</span>
<span id="annotated-cell-5-17"><a href="#annotated-cell-5-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="annotated-cell-5-18"><a href="#annotated-cell-5-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-5-19"><a href="#annotated-cell-5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-5-20"><a href="#annotated-cell-5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(missingness) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="10" onclick="event.preventDefault();">10</a><span id="annotated-cell-5-21" class="code-annotation-target"><a href="#annotated-cell-5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="sc">!!</span><span class="fu">sym</span>(column) <span class="sc">:</span><span class="er">=</span> missingness) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-22"><a href="#annotated-cell-5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>()</span>
<span id="annotated-cell-5-23"><a href="#annotated-cell-5-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-5-24"><a href="#annotated-cell-5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="annotated-cell-5-25"><a href="#annotated-cell-5-25" aria-hidden="true" tabindex="-1"></a>}</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="3" data-code-annotation="1">For each row in the column, <code>!is.na()</code> returns <code>TRUE</code> (1) is non-missing or <code>FALSE</code> (0) if missing. <code>which()</code> then returns a vector of indices where the non-missing values are. <code>max()</code> then identifies the last row where non-missing data exists. Up to and including this row, <code>drop_off</code> is <code>FALSE</code>, becoming <code>TRUE</code> for every row thereafter.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="6" data-code-annotation="2">We then need to update <code>drop_off</code> if there are any non-missing responses within the question group. I’ll explain why later, but the group minimum of <code>drop_off</code> will set all rows to <code>FALSE</code> if any <code>FALSE</code> exists.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="7,8" data-code-annotation="3">Then the number of variables within a group <code>n_vars</code> and number of missing responses within a group <code>n_missing</code> are calculated</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="4">With these elements now created, we can use <code>case_when()</code> to apply the missing coding</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="10" data-code-annotation="5">Due to step 2, we can be confident that <code>drop_off == TRUE</code> correctly identifies where responses have dropped off</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="11" data-code-annotation="6">The value <code>-888888</code> identifies missingness at the question group level. If the number of missing responses within the question group is equal to the number of questions within said group, that is missing at the question group-level. <code>n_vars &gt; 1</code> is included since I consider groups to mean a collection of 2 or more questions.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="12,13,14" data-code-annotation="7">In this condition, any missing values <code>is.na(!!sym(column))</code> for a factor question <code>type == "factor"</code> where there are non-missing values within the question group <code>n_missing != n_vars</code> are coded to 0</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="15" data-code-annotation="8">Any remaining missing values can be coded as plain old <code>-999999</code></span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="16" data-code-annotation="9">Any rows that didn’t meet any of these rules are left as-is</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="21" data-code-annotation="10">Finally, rename the <code>missingness</code> column to whatever the current value of the column input is, since we’re going to iterate over every column</span>
</dd>
</dl>
</div>
</div>
<p>Now that this function is defined, we can apply it to the relevant columns of the data, which are currently named <code>V1</code> through <code>V5</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span> <span class="fu">names</span>(survey_data_tranposed <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">"V</span><span class="sc">\\</span><span class="st">d"</span>)))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use purrr:map to iterate over the columns identified in `responses`</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>survey_data_coded <span class="ot">&lt;-</span> <span class="fu">map</span>(responses, \(x) <span class="fu">code_missingness</span>(survey_data_tranposed, x)) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>survey_data_tranposed <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(survey_data_coded <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_with</span>( <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_new"</span>), <span class="fu">matches</span>(<span class="st">"V</span><span class="sc">\\</span><span class="st">d"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable, variable_group, type, <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"V1"</span>,<span class="st">"V2"</span>,<span class="st">"V3"</span>,<span class="st">"V4"</span>,<span class="st">"V5"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ahaptoalnd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ahaptoalnd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ahaptoalnd thead, #ahaptoalnd tbody, #ahaptoalnd tfoot, #ahaptoalnd tr, #ahaptoalnd td, #ahaptoalnd th {
  border-style: none;
}

#ahaptoalnd p {
  margin: 0;
  padding: 0;
}

#ahaptoalnd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ahaptoalnd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ahaptoalnd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ahaptoalnd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ahaptoalnd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ahaptoalnd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahaptoalnd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ahaptoalnd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ahaptoalnd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ahaptoalnd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ahaptoalnd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ahaptoalnd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ahaptoalnd .gt_spanner_row {
  border-bottom-style: hidden;
}

#ahaptoalnd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ahaptoalnd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ahaptoalnd .gt_from_md > :first-child {
  margin-top: 0;
}

#ahaptoalnd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ahaptoalnd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ahaptoalnd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ahaptoalnd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ahaptoalnd .gt_row_group_first td {
  border-top-width: 2px;
}

#ahaptoalnd .gt_row_group_first th {
  border-top-width: 2px;
}

#ahaptoalnd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahaptoalnd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ahaptoalnd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ahaptoalnd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahaptoalnd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahaptoalnd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ahaptoalnd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ahaptoalnd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ahaptoalnd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahaptoalnd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ahaptoalnd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahaptoalnd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ahaptoalnd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahaptoalnd .gt_left {
  text-align: left;
}

#ahaptoalnd .gt_center {
  text-align: center;
}

#ahaptoalnd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ahaptoalnd .gt_font_normal {
  font-weight: normal;
}

#ahaptoalnd .gt_font_bold {
  font-weight: bold;
}

#ahaptoalnd .gt_font_italic {
  font-style: italic;
}

#ahaptoalnd .gt_super {
  font-size: 65%;
}

#ahaptoalnd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ahaptoalnd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ahaptoalnd .gt_indent_1 {
  text-indent: 5px;
}

#ahaptoalnd .gt_indent_2 {
  text-indent: 10px;
}

#ahaptoalnd .gt_indent_3 {
  text-indent: 15px;
}

#ahaptoalnd .gt_indent_4 {
  text-indent: 20px;
}

#ahaptoalnd .gt_indent_5 {
  text-indent: 25px;
}

#ahaptoalnd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ahaptoalnd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="variable_group" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable_group</th>
<th id="type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">type</th>
<th id="V1" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V1</th>
<th id="V1_new" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V1_new</th>
<th id="V2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V2</th>
<th id="V2_new" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V2_new</th>
<th id="V3" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V3</th>
<th id="V3_new" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V3_new</th>
<th id="V4" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V4</th>
<th id="V4_new" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V4_new</th>
<th id="V5" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V5</th>
<th id="V5_new" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">V5_new</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">id</td>
<td class="gt_row gt_left" headers="variable_group">id</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V1_new">1</td>
<td class="gt_row gt_left" headers="V2">2</td>
<td class="gt_row gt_left" headers="V2_new">2</td>
<td class="gt_row gt_left" headers="V3">3</td>
<td class="gt_row gt_left" headers="V3_new">3</td>
<td class="gt_row gt_left" headers="V4">4</td>
<td class="gt_row gt_left" headers="V4_new">4</td>
<td class="gt_row gt_left" headers="V5">5</td>
<td class="gt_row gt_left" headers="V5_new">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">name_first</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Tom</td>
<td class="gt_row gt_left" headers="V1_new">Tom</td>
<td class="gt_row gt_left" headers="V2">Penny</td>
<td class="gt_row gt_left" headers="V2_new">Penny</td>
<td class="gt_row gt_left" headers="V3">Trevor</td>
<td class="gt_row gt_left" headers="V3_new">Trevor</td>
<td class="gt_row gt_left" headers="V4">Ursula</td>
<td class="gt_row gt_left" headers="V4_new">Ursula</td>
<td class="gt_row gt_left" headers="V5">Jenny</td>
<td class="gt_row gt_left" headers="V5_new">Jenny</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">name_last</td>
<td class="gt_row gt_left" headers="variable_group">name</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Smith</td>
<td class="gt_row gt_left" headers="V1_new">Smith</td>
<td class="gt_row gt_left" headers="V2">Jones</td>
<td class="gt_row gt_left" headers="V2_new">Jones</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-999999</td>
<td class="gt_row gt_left" headers="V4">Smith</td>
<td class="gt_row gt_left" headers="V4_new">Smith</td>
<td class="gt_row gt_left" headers="V5">Jones</td>
<td class="gt_row gt_left" headers="V5_new">Jones</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">age</td>
<td class="gt_row gt_left" headers="variable_group">age</td>
<td class="gt_row gt_left" headers="type">numeric</td>
<td class="gt_row gt_left" headers="V1">62</td>
<td class="gt_row gt_left" headers="V1_new">62</td>
<td class="gt_row gt_left" headers="V2">52</td>
<td class="gt_row gt_left" headers="V2_new">52</td>
<td class="gt_row gt_left" headers="V3">37</td>
<td class="gt_row gt_left" headers="V3_new">37</td>
<td class="gt_row gt_left" headers="V4">44</td>
<td class="gt_row gt_left" headers="V4_new">44</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">-999999</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x1</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">0</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">1</td>
<td class="gt_row gt_left" headers="V3_new">1</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V4_new">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x2</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V1_new">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">0</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">0</td>
<td class="gt_row gt_left" headers="V5_new">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">x3</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">0</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V2_new">1</td>
<td class="gt_row gt_left" headers="V3">0</td>
<td class="gt_row gt_left" headers="V3_new">0</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">1</td>
<td class="gt_row gt_left" headers="V5_new">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">x_text</td>
<td class="gt_row gt_left" headers="variable_group">x</td>
<td class="gt_row gt_left" headers="type">string</td>
<td class="gt_row gt_left" headers="V1">Lorem</td>
<td class="gt_row gt_left" headers="V1_new">Lorem</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V2_new">-999999</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-999999</td>
<td class="gt_row gt_left" headers="V4">Lorem</td>
<td class="gt_row gt_left" headers="V4_new">Lorem</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">-999999</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y1</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">1</td>
<td class="gt_row gt_left" headers="V1_new">1</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">-888888</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">y2</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">0</td>
<td class="gt_row gt_left" headers="V2">NA</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V4_new">1</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">-888888</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">y3</td>
<td class="gt_row gt_left" headers="variable_group">y</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">0</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V2_new">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">-888888</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z1</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">-777777</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">NA</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">1</td>
<td class="gt_row gt_left" headers="V5_new">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">z2</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">-777777</td>
<td class="gt_row gt_left" headers="V2">1</td>
<td class="gt_row gt_left" headers="V2_new">1</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">1</td>
<td class="gt_row gt_left" headers="V4_new">1</td>
<td class="gt_row gt_left" headers="V5">0</td>
<td class="gt_row gt_left" headers="V5_new">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">z3</td>
<td class="gt_row gt_left" headers="variable_group">z</td>
<td class="gt_row gt_left" headers="type">factor</td>
<td class="gt_row gt_left" headers="V1">NA</td>
<td class="gt_row gt_left" headers="V1_new">-777777</td>
<td class="gt_row gt_left" headers="V2">0</td>
<td class="gt_row gt_left" headers="V2_new">0</td>
<td class="gt_row gt_left" headers="V3">NA</td>
<td class="gt_row gt_left" headers="V3_new">-777777</td>
<td class="gt_row gt_left" headers="V4">0</td>
<td class="gt_row gt_left" headers="V4_new">0</td>
<td class="gt_row gt_left" headers="V5">NA</td>
<td class="gt_row gt_left" headers="V5_new">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It looks to have done the job I intended it to do:</p>
<ul>
<li>Trevor has <code>-999999</code> for last name and the <code>x</code> text variable, and <code>-777777</code> from questions <code>y</code> onward</li>
<li>Jenny has group-level missingness <code>-888888</code> for the <code>y</code> questions, because she goes on to answer the <code>z</code> questions so has not dropped off</li>
<li>Missing responses to factor questions in a group are coded to <code>0</code> when a non-missing response exists on any other question</li>
</ul>
</section>
<section id="some-explanations" class="level2">
<h2 class="anchored" data-anchor-id="some-explanations">Some explanations</h2>
<p>The reason why I update the value of <code>drop_off</code> after grouping (annotation 2) is because of the underlying structure of the data I’m working with, which isn’t quite reflected in the example data. When outputting checkboxes, REDCap (a survey platform) auto-populates unchecked boxes with a <code>0</code> as opposed to missing. To work around this in the context of missingness, I first replace every <code>0</code> for these checkbox variables with <code>NA</code> so that I’m left with only values of <code>1</code> or <code>NA</code>. You might be thinking “someone could reasonably have answered the question by not ticking any boxes”, except that we provide ‘no’ and ‘unsure’ checkboxes to reasonably cover all response options. So if these options are 0 in addition to the other options, I feel more confident in saying the whole question group was skipped.</p>
<p>The original reason for asking the question was about performance, and this approach is probably slower than a column-wise solution. It takes around 10 minutes to iterate over ~6,500 responses to ~550 variables across ~100 question groups. In the future this isn’t going to be an issue because the data cleaning is going to be run on a frequent basis as data comes in (so smaller batches), rather than the entire set of responses.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/benharrap\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>